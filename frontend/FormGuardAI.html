<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>FormGuard AI â€“ Web Prototype (Simulated)</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <style>
    :root {
      --bg: #020617;
      --card-bg: #020617;
      --accent: #38bdf8;
      --accent-soft: rgba(56, 189, 248, 0.2);
      --border: #1e293b;
      --danger: #f97373;
      --text: #e5e7eb;
      --muted: #9ca3af;
      --radius-xl: 24px;
      --radius-lg: 16px;
      --shadow-soft: 0 24px 60px rgba(15, 23, 42, 0.9);
    }

    * { box-sizing: border-box; }

    body {
      margin: 0;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "SF Pro Text",
        "Segoe UI", sans-serif;
      background: radial-gradient(circle at top, #0f172a 0, #020617 40%, #000 100%);
      color: var(--text);
      min-height: 100vh;
      display: flex;
      justify-content: center;
      align-items: flex-start;
      padding: 32px 16px;
    }

    .container {
      width: 100%;
      max-width: 1180px;
      background: linear-gradient(135deg, rgba(15, 23, 42, 0.98), #020617);
      border-radius: 28px;
      padding: 20px 22px 26px;
      border: 1px solid rgba(148, 163, 184, 0.22);
      box-shadow: var(--shadow-soft);
      position: relative;
      overflow: hidden;
    }

    .glow {
      position: absolute;
      width: 320px;
      height: 320px;
      border-radius: 999px;
      background: radial-gradient(circle, rgba(56, 189, 248, 0.5), transparent 65%);
      top: -80px;
      right: -80px;
      filter: blur(3px);
      opacity: 0.95;
      pointer-events: none;
    }

    header {
      display: flex;
      justify-content: space-between;
      gap: 20px;
      margin-bottom: 20px;
      position: relative;
      z-index: 1;
    }

    .brand {
      display: flex;
      align-items: center;
      gap: 14px;
    }

    .brand-logo {
      width: 44px;
      height: 44px;
      border-radius: 18px;
      background: radial-gradient(circle at 30% 0, #fb923c, #ea580c);
      display: flex;
      align-items: center;
      justify-content: center;
      color: #fffbeb;
      font-weight: 800;
      font-size: 20px;
      box-shadow: 0 16px 32px rgba(248, 113, 113, 0.45);
      border: 1px solid rgba(248, 250, 252, 0.5);
    }

    .brand-text h1 {
      margin: 0;
      font-size: 24px;
      letter-spacing: 0.03em;
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .pill {
      padding: 4px 10px;
      border-radius: 999px;
      border: 1px solid rgba(148, 163, 184, 0.8);
      font-size: 11px;
      color: var(--muted);
      font-weight: 500;
      white-space: nowrap;
      background: rgba(15, 23, 42, 0.8);
    }

    .brand-text p {
      margin: 4px 0 0;
      font-size: 13px;
      color: var(--muted);
    }

    .meta {
      font-size: 11px;
      color: var(--muted);
      text-align: right;
      display: flex;
      flex-direction: column;
      justify-content: center;
      gap: 4px;
    }

    .meta .label {
      text-transform: uppercase;
      letter-spacing: 0.16em;
      font-size: 10px;
    }

    .meta .value {
      font-size: 12px;
    }

    .meta .badge {
      align-self: flex-end;
      padding: 4px 11px;
      border-radius: 999px;
      border: 1px solid rgba(52, 211, 153, 0.7);
      background: rgba(6, 78, 59, 0.9);
      color: #bbf7d0;
      font-size: 11px;
    }

    @media (max-width: 880px) {
      header { flex-direction: column; align-items: flex-start; }
      .meta { text-align: left; align-items: flex-start; }
    }

    .layout {
      display: grid;
      grid-template-columns: minmax(0, 1.05fr) minmax(0, 1.05fr);
      gap: 18px;
      position: relative;
      z-index: 1;
    }

    @media (max-width: 880px) {
      .layout { grid-template-columns: 1fr; }
    }

    .card {
      background: radial-gradient(circle at top, #020617 0, #020617 45%, #020617 100%);
      border-radius: var(--radius-xl);
      border: 1px solid var(--border);
      padding: 16px 16px 18px;
      position: relative;
      overflow: hidden;
    }

    .card-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 10px;
    }

    .card-title {
      font-size: 13px;
      font-weight: 600;
      letter-spacing: 0.08em;
      text-transform: uppercase;
      color: #9ca3af;
    }

    .badge-outline {
      padding: 3px 8px;
      border-radius: 999px;
      border: 1px solid rgba(148, 163, 184, 0.78);
      font-size: 11px;
      color: var(--muted);
      display: inline-flex;
      align-items: center;
      gap: 6px;
    }

    .dot {
      width: 8px;
      height: 8px;
      border-radius: 999px;
      background: #22c55e;
      box-shadow: 0 0 0 3px rgba(34, 197, 94, 0.35);
    }

    .label-line {
      display: flex;
      justify-content: space-between;
      align-items: center;
      font-size: 12px;
      color: var(--muted);
      margin-bottom: 6px;
    }

    .label-line span.right {
      font-size: 11px;
      color: #64748b;
    }

    textarea {
      width: 100%;
      background: rgba(15, 23, 42, 0.98);
      border-radius: var(--radius-lg);
      border: 1px solid rgba(51, 65, 85, 0.96);
      padding: 9px 10px;
      font-size: 13px;
      color: var(--text);
      min-height: 150px;
      resize: vertical;
      outline: none;
      font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
    }

    textarea:focus {
      border-color: var(--accent);
      box-shadow: 0 0 0 1px var(--accent-soft);
    }

    .hint {
      font-size: 11px;
      color: #64748b;
      margin-top: 6px;
    }

    .file-row {
      display: flex;
      align-items: center;
      gap: 10px;
      margin-top: 10px;
      font-size: 12px;
      color: var(--muted);
      flex-wrap: wrap;
    }

    .file-row input[type="file"] {
      font-size: 11px;
      max-width: 240px;
    }

    .button-row {
      margin-top: 12px;
      display: flex;
      gap: 10px;
      flex-wrap: wrap;
    }

    button { font-family: inherit; }

    .btn-primary {
      padding: 8px 16px;
      border-radius: 999px;
      border: none;
      background: radial-gradient(circle at 30% 0, #38bdf8, #0ea5e9);
      color: #0b1120;
      font-size: 13px;
      font-weight: 600;
      display: inline-flex;
      align-items: center;
      gap: 6px;
      cursor: pointer;
      box-shadow: 0 16px 32px rgba(56, 189, 248, 0.55);
    }

    .btn-primary:active {
      transform: translateY(1px);
      box-shadow: 0 10px 22px rgba(56, 189, 248, 0.5);
    }

    .btn-secondary {
      padding: 7px 13px;
      border-radius: 999px;
      border: 1px solid rgba(148, 163, 184, 0.78);
      background: rgba(15, 23, 42, 0.96);
      color: var(--muted);
      font-size: 12px;
      cursor: pointer;
    }

    .btn-secondary:active { transform: translateY(1px); }
    .btn-secondary:disabled { opacity: 0.5; cursor: default; }

    .status-bar {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 10px;
      font-size: 11px;
      color: var(--muted);
    }

    .status-left {
      display: flex;
      align-items: center;
      gap: 6px;
    }

    .status-indicator {
      width: 7px;
      height: 7px;
      border-radius: 999px;
      background: var(--accent);
    }

    .score-pill {
      padding: 3px 9px;
      border-radius: 999px;
      background: rgba(15, 23, 42, 0.95);
      border: 1px solid rgba(56, 189, 248, 0.7);
      font-size: 11px;
      color: #e0f2fe;
    }

    .output-group {
      display: grid;
      grid-template-rows: auto auto 1fr;
      gap: 10px;
      height: 100%;
    }

    .summary {
      background: rgba(15, 23, 42, 0.96);
      border-radius: 16px;
      border: 1px solid rgba(30, 64, 175, 0.85);
      padding: 8px 10px;
      font-size: 12px;
    }

    .summary-title {
      font-size: 12px;
      font-weight: 600;
      color: #bfdbfe;
      margin-bottom: 4px;
    }

    .summary-list {
      margin: 0;
      padding-left: 16px;
      color: #cbd5f5;
    }

    .summary-list li { margin-bottom: 2px; }

    .result-box {
      background: rgba(15, 23, 42, 0.96);
      border-radius: 16px;
      border: 1px solid rgba(30, 64, 175, 0.82);
      padding: 9px 10px;
      font-size: 12px;
      max-height: 210px;
      overflow: auto;
      white-space: pre-wrap;
      line-height: 1.45;
    }

    .result-title {
      font-size: 12px;
      font-weight: 600;
      color: #bfdbfe;
      margin-bottom: 4px;
    }

    .result-sub {
      font-size: 11px;
      color: #64748b;
      margin-bottom: 4px;
    }

    .issues-list {
      padding-left: 16px;
      margin: 0;
    }

    .issues-list li { margin-bottom: 4px; }

    .issues-list span.badge {
      font-size: 10px;
      padding: 1px 6px;
      border-radius: 999px;
      border: 1px solid rgba(248, 250, 252, 0.2);
      margin-right: 4px;
    }

    .badge-missing {
      color: #fecaca;
      border-color: rgba(248, 113, 113, 0.75);
    }

    .badge-format {
      color: #e5e7eb;
      border-color: rgba(129, 140, 248, 0.9);
    }

    .badge-logic {
      color: #fde68a;
      border-color: rgba(250, 204, 21, 0.85);
    }

    .download-row {
      margin-top: 8px;
      display: flex;
      justify-content: flex-end;
    }

    .note {
      margin-top: 8px;
      font-size: 11px;
      color: #64748b;
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="glow"></div>

    <header>
      <div class="brand">
        <div class="brand-logo">F</div>
        <div class="brand-text">
          <h1>
            FormGuard AI
            <span class="pill">ðŸ“ˆ Intended for Future Web Deployment</span>
          </h1>
          <p>Intelligent pre-validation for healthcare forms and census files.</p>
        </div>
      </div>
      <div class="meta">
        <span class="label">Virtual Startup | GenAI + SDLC</span>
        <span class="value">Ali Arslan Â· COT 6930</span>
        <span class="badge">MVP v1.0 Â· Colab Backend</span>
      </div>
    </header>

    <main class="layout">
      <!-- LEFT: INPUT -->
      <section class="card">
        <div class="card-header">
          <span class="card-title">FORM INPUT</span>
          <span class="badge-outline">
            <span class="dot"></span>
            Simulated Web UI
          </span>
        </div>

        <div class="label-line">
          <span>Form content</span>
          <span class="right">Paste text or upload CSV</span>
        </div>
        <textarea id="formInput" placeholder='"FirstName,LastName,Relationship,DOB,Gender,CoverageType,StartDate,EndDate,Address,City,State,Zip"
"John,Smith,Subscriber,1985-03-12,M,EE,2024-11-01,2024-11-30,123 Lakeview Rd,Grand Rapids,MI,49501"
"Sarah,Smith,Spouse,1987-07-22,F,ES,2024-11-01,2024-11-30,123 Lakeview Rd,Grand Rapids,MI,49501"
"Noah,Smith,Child,2014-05-03,M,EC,2024-11-01,2024-11-30,123 Lakeview Rd,Grand Rapids,MI,49501"'></textarea>

        <div class="hint">
          Example: census rows with FirstName, LastName, DOB, StartDate, EndDate, CoverageType, etc.
        </div>

        <div class="file-row">
          <input type="file" id="fileInput" accept=".csv,.txt" />
          <span>Optional: upload a .csv or .txt (demo only, processed locally).</span>
        </div>

        <div class="button-row">
          <button class="btn-primary" id="validateBtn">â–¶ Run Validation</button>
          <button class="btn-secondary" id="clearBtn">Clear</button>
        </div>

        <div class="hint">
          Note: This HTML prototype simulates the behavior of FormGuard AI. The full LLM-powered
          validation pipeline runs in the Colab MVP.
        </div>
      </section>

      <!-- RIGHT: OUTPUT -->
      <section class="card">
        <div class="card-header">
          <span class="card-title">VALIDATION OUTPUT</span>
          <span class="badge-outline">
            <span class="dot"></span>
            Human-in-the-loop Preview
          </span>
        </div>

        <div class="status-bar">
          <div class="status-left">
            <span class="status-indicator"></span>
            <span id="statusText">Idle â€“ simulated run not started.</span>
          </div>
          <span class="score-pill" id="scorePill">Score: â€”</span>
        </div>

        <div class="output-group">
          <!-- Summary -->
          <div class="summary">
            <div class="summary-title">Summary (Simulated GenAI Interpretation)</div>
            <ul class="summary-list" id="summaryList">
              <li>Waiting for validationâ€¦</li>
            </ul>
          </div>

          <!-- Issues -->
          <div class="result-box">
            <div class="result-title">Issues (Simulated)</div>
            <div class="result-sub">
              Run validation to see potential missing fields and inconsistencies.
            </div>
            <ul class="issues-list" id="issuesList">
              <li>- No obvious issues detected in this simulated frontend preview.</li>
            </ul>
          </div>

          <!-- Corrected Form -->
          <div>
            <div class="result-title">Corrected Form (Simulated)</div>
            <div class="result-sub">
              This preview represents how FormGuard AI restructures your form.
            </div>
            <div class="result-box" id="formViewBox">
Waiting for validationâ€¦
            </div>

            <div class="download-row">
              <button id="downloadBtn" class="btn-secondary" disabled>
                â¬‡ Download corrected form
              </button>
            </div>

            <p class="note">
              This UI represents the intended web-based experience. For this project, the backend
              GenAI logic is implemented and tested in a Google Colab MVP.
            </p>
          </div>
        </div>
      </section>
    </main>
  </div>

  <script>
    // Always demo-mode â€“ no real API calls
    const USE_DEMO_MODE = true;

    const formInput   = document.getElementById("formInput");
    const fileInput   = document.getElementById("fileInput");
    const validateBtn = document.getElementById("validateBtn");
    const clearBtn    = document.getElementById("clearBtn");

    const statusText  = document.getElementById("statusText");
    const scorePill   = document.getElementById("scorePill");
    const summaryList = document.getElementById("summaryList");
    const issuesList  = document.getElementById("issuesList");
    const formViewBox = document.getElementById("formViewBox");
    const downloadBtn = document.getElementById("downloadBtn");

    let latestCorrectedText = "";
    let latestOriginalText  = "";

    // File upload â†’ textarea
    fileInput.addEventListener("change", (event) => {
      const file = event.target.files[0];
      if (!file) return;
      const reader = new FileReader();
      reader.onload = (e) => { formInput.value = e.target.result; };
      reader.readAsText(file);
    });

    // Run validation (simulated)
    validateBtn.addEventListener("click", async () => {
      const text = formInput.value.trim();
      if (!text) {
        alert("Please paste form content or upload a file first.");
        return;
      }

      latestOriginalText = text;
      setStatus("Running simulated GenAI validationâ€¦");
      setScore("â€¦");
      setSummary(["Analyzing structure and looking for common issuesâ€¦"]);
      setIssues(["Analyzingâ€¦"]);
      setFormView("Processingâ€¦");
      downloadBtn.disabled = true;

      try {
        let result;
        if (USE_DEMO_MODE) {
          result = simulateGenAIValidation(text);
        } else {
          result = await realGenAIValidation(text);
        }

        latestCorrectedText = result.correctedForm || text;

        setStatus("Simulated run completed â€“ this UI mirrors the web-based vision.");
        setScore(result.score + "/100");

        const top3 = (result.summary || []);
        setSummary(top3.length ? top3 : ["No major issues detected."]);

        renderIssues(result.issues);
        setFormView(latestCorrectedText);
        downloadBtn.disabled = false;
      } catch (err) {
        console.error(err);
        setStatus("Error running validation (fallback results shown).");
        setScore("â€”");
        setSummary(["Validation encountered an error, but a basic corrected view is still shown."]);
        setIssues(["Simulator fallback mode used."]);
        latestCorrectedText = text + "\n\n# Simulated note: basic validation fallback applied.";
        setFormView(latestCorrectedText);
        downloadBtn.disabled = false;
      }
    });

    // Clear everything
    clearBtn.addEventListener("click", () => {
      formInput.value = "";
      latestCorrectedText = "";
      latestOriginalText  = "";
      fileInput.value     = "";

      setStatus("Idle â€“ simulated run not started.");
      setScore("â€”");
      setSummary(["Waiting for validationâ€¦"]);
      setIssues(["- No obvious issues detected in this simulated frontend preview."]);
      setFormView("Waiting for validationâ€¦");
      downloadBtn.disabled = true;
    });

    // Download corrected form as .txt (whatever is shown)
    downloadBtn.addEventListener("click", () => {
      if (downloadBtn.disabled) return;
      const text = formViewBox.textContent || "";
      if (!text.trim()) {
        alert("No corrected form available. Please run validation first.");
        return;
      }
      const blob = new Blob([text], { type: "text/plain;charset=utf-8" });
      const url  = URL.createObjectURL(blob);
      const a    = document.createElement("a");
      a.href = url;
      a.download = "formguard_corrected_form.txt";
      document.body.appendChild(a);
      a.click();
      document.body.removeChild(a);
      URL.revokeObjectURL(url);
    });

    // UI helper functions
    function setStatus(msg) { statusText.textContent = msg; }
    function setScore(text) { scorePill.textContent = "Score: " + text; }

    function setSummary(lines) {
      summaryList.innerHTML = "";
      lines.forEach((l) => {
        const li = document.createElement("li");
        li.textContent = l;
        summaryList.appendChild(li);
      });
    }

    function setIssues(linesOrObjects) {
      issuesList.innerHTML = "";
      if (!linesOrObjects || !linesOrObjects.length) {
        const li = document.createElement("li");
        li.textContent = "No issues detected.";
        issuesList.appendChild(li);
        return;
      }
      if (typeof linesOrObjects[0] === "string") {
        linesOrObjects.forEach((line) => {
          const li = document.createElement("li");
          li.textContent = line;
          issuesList.appendChild(li);
        });
      } else {
        linesOrObjects.forEach((issue) => {
          const li = document.createElement("li");
          const badge = document.createElement("span");
          badge.classList.add("badge");
          if (issue.type === "missing") badge.classList.add("badge-missing");
          if (issue.type === "format")  badge.classList.add("badge-format");
          if (issue.type === "logic")   badge.classList.add("badge-logic");
          li.appendChild(badge);
          li.append(" " + issue.description);
          issuesList.appendChild(li);
        });
      }
    }

    function setFormView(text) {
      formViewBox.textContent = text;
    }

    // Very robust, never-throw simulator
    function simulateGenAIValidation(text) {
      const result = {
        score: 97,
        issues: [],
        summary: [],
        correctedForm: text
      };

      try {
        const rawLines = text.split(/\r?\n/);
        const lines = rawLines.map(l => l.trim()).filter(l => l !== "");
        if (lines.length === 0) {
          result.summary.push("Input appears empty or whitespace only.");
          result.issues.push({
            type: "missing",
            description: "No usable lines were detected in this file."
          });
          result.correctedForm = text + "\n\n# Simulated note: please provide at least one header row and one data row.";
          result.score = 60;
          return result;
        }

        const header = lines[0].split(",");
        const hasDOB   = header.some(h => /dob/i.test(h));
        const hasStart = header.some(h => /startdate/i.test(h));
        const hasEnd   = header.some(h => /enddate/i.test(h));

        const dobIdx   = header.findIndex(h => /dob/i.test(h));
        const startIdx = header.findIndex(h => /startdate/i.test(h));
        const endIdx   = header.findIndex(h => /enddate/i.test(h));

        let missingCount = 0;
        let formatCount  = 0;
        let logicCount   = 0;

        for (let i = 1; i < lines.length; i++) {
          const cols = lines[i].split(",");
          const row  = i + 1;

          // DOB checks
          if (hasDOB && dobIdx >= 0) {
            const dob = (cols[dobIdx] || "").trim();
            if (!dob || !/^\d{4}-\d{2}-\d{2}$/.test(dob)) {
              result.issues.push({
                type: "format",
                description: `Row ${row}: DOB appears missing or not in YYYY-MM-DD format.`
              });
              formatCount++;
            }
          }

          // Start/End checks
          if (hasStart && hasEnd && startIdx >= 0 && endIdx >= 0) {
            const start = (cols[startIdx] || "").trim();
            const end   = (cols[endIdx] || "").trim();
            if (!start || !end) {
              result.issues.push({
                type: "missing",
                description: `Row ${row}: StartDate or EndDate appears to be missing.`
              });
              missingCount++;
            } else {
              const startTime = Date.parse(start);
              const endTime   = Date.parse(end);
              if (isNaN(startTime) || isNaN(endTime)) {
                result.issues.push({
                  type: "format",
                  description: `Row ${row}: StartDate or EndDate is not a valid calendar date.`
                });
                formatCount++;
              } else if (startTime > endTime) {
                result.issues.push({
                  type: "logic",
                  description: `Row ${row}: StartDate is after EndDate (coverage window is reversed).`
                });
                logicCount++;
              }
            }
          }
        }

        // Score calculation
        let score = 100;
        score -= missingCount * 4;
        score -= formatCount  * 3;
        score -= logicCount   * 5;
        if (score < 40) score = 40;
        if (score > 100) score = 100;
        result.score = score;

        if (result.issues.length === 0) {
          result.summary.push("No critical structural issues detected in this simulated run.");
          result.correctedForm =
            text + "\n\n# Simulated review: no major issues detected. Ready for backend processing.";
        } else {
          result.summary.push(
            `Detected ${result.issues.length} potential issues across ${lines.length - 1} records.`
          );
          result.correctedForm =
            text +
            "\n\n# Simulated notes (these would guide a human reviewer or automated fix):\n" +
            result.issues
              .map((issue, idx) => `# ${idx + 1}. ${issue.description}`)
              .join("\n");
        }

        return result;
      } catch (e) {
        console.error("simulateGenAIValidation error:", e);
        result.score = 80;
        result.summary.push(
          "Simulator could not fully parse the input, but a basic corrected view is provided."
        );
        result.issues.push({
          type: "format",
          description:
            "Input format was unusual; in the real system, the LLM still analyzes raw text."
        });
        result.correctedForm =
          text +
          "\n\n# Simulated fallback: parser encountered an issue, but this is what would be sent to the LLM.";
        return result;
      }
    }

    async function realGenAIValidation(text) {
      // Not used in this prototype â€“ kept only as a placeholder hook.
      throw new Error("realGenAIValidation is not implemented in this prototype.");
    }
  </script>
</body>
</html>
